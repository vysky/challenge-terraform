# challenge-terraform

## challenge 1 - vm scaleset

modify the code from this [microsoft article](https://docs.microsoft.com/azure/developer/terraform/create-vm-scaleset-network-disks-hcl) so it can be deployed to acloudguru sandbox on azure

steps to modify the code

variables.tf
1. replace the default value of `variable "resource_group_name"` with the resource group name generated by acloudguru sandbox
2. add `default = <password>` under `variable "admin_password"` so there will be no more prompt, make sure the password fits the password requirements

main.tf
1. comment out `resource "azurerm_resource_group" "vmss"` block
2. replace all `azurerm_resource_group.vmss.name` with `var.resource_group_name`
3. add `skip_provider_registration = true` under `provider "azurezm"`

---

## challenge 2 - kubernetes

modify the code from this [microsoft article](https://docs.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks) so it can be deployed to acloudguru sandbox on azure

steps to modify the code

generate ssh key
1. run `ssh-keygen -m PEM -t rsa -b 4096` in terminal
2. do not enter anything when prompted and leave all as default

main.tf
1. comment out `resource "azurerm_resource_group" "rg"` block
2. add `skip_provider_registration = true` under `provider "azurerm"`

variables.tf
1. comment out `variable "client_id" {}` and `variable "client_secret" {}`
2. replace the default value of `variable "location"` with `eastus`
3. replace the default value of `variable "resource_group_name"` with the resource group name generated by acloudguru sandbox

k8s.tf
1. comment out `resource "azurerm_resource_group" "k8s"` block
2. comment out `service_principal` block
3. replace all `azurerm_resource_group.k8s.name` with `var.resource_group_name`
4. replace `azurerm_resource_group.k8s.location` with `var.location`
5. replace `"Standard_D2_v2"` with `"Standard_DS2_v2"`
5. add `identity { type = "SystemAssigned" }` under `resource "azurerm_kubernetes_cluster" "k8s"`